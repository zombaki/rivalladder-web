<div class="profile-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>person</mat-icon>
        <span>My Profile</span>
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <div class="profile-photo-section" *ngIf="user$ | async as user">
        <img 
          [src]="user.photoUrl || 'assets/default-avatar.png'" 
          alt="Profile photo"
          class="user-avatar-large"
        />
        <div class="photo-upload">
          <input 
            type="file" 
            #fileInput 
            accept="image/*" 
            (change)="onFileSelected($event)"
            style="display: none"
          />
          <button mat-raised-button color="primary" (click)="fileInput.click()">
            <mat-icon>upload</mat-icon>
            Change Photo
          </button>
          <button 
            mat-raised-button 
            *ngIf="selectedFile"
            (click)="uploadPhoto()"
          >
            Upload
          </button>
        </div>
      </div>

      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <div class="name-row">
          <mat-form-field appearance="outline">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" />
            <mat-error *ngIf="profileForm.get('firstName')?.hasError('required')">
              First name is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" />
            <mat-error *ngIf="profileForm.get('lastName')?.hasError('required')">
              Last name is required
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Phone</mat-label>
          <input matInput formControlName="phone" />
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Skill Level</mat-label>
          <input matInput formControlName="skillLevel" />
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Bio</mat-label>
          <textarea matInput formControlName="bio" rows="4"></textarea>
        </mat-form-field>

        <div class="actions">
          <button 
            mat-raised-button 
            color="primary" 
            type="submit"
            [disabled]="!profileForm.valid"
          >
            <mat-icon>save</mat-icon>
            Save Changes
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
